@page
@addTagHelper*, Microsoft.AspNetCore.Mvc.TagHelpers

@model FrotiX.Pages.Requisitante.UpsertModel

@{
	ViewData["Title"] = "Requisitantes";
	ViewData["PageName"] = "requisitante_upsert";
	ViewData["Heading"] = "<i class='fa-duotone fa-user-tie'></i> Cadastros: <span class='fw-300'>Requisitantes</span>";
	ViewData["Category1"] = "Cadastros";
	ViewData["PageIcon"] = "fa-duotone fa-user-tie";
}

<style>
	.form-control-xs {
		height: calc(1em + .775rem + 2px) !important;
		padding: .125rem .25rem !important;
		font-size: .75rem !important;
		line-height: 1.5;
		border-radius: .2rem;
	}

	.label {
		margin-bottom: -5px;
		margin-top: 10px;
	}

	input[type=checkbox] {
		vertical-align: middle;
		position: relative;
		bottom: 1px;
	}
</style>

@section HeadBlock {
}

<form method="post" asp-action="Upsert">
	<div class="row">
		<div class="col-xl-12">
			<div id="panel-1" class="panel">
				<div class="panel-container show">
					<div class="panel-content">
						<div asp-validation-summary="ModelOnly" class="text-danger"></div>

						@if (Model.RequisitanteObj.Requisitante.RequisitanteId != Guid.Empty)
						{
							<input type="hidden" asp-for="RequisitanteObj.Requisitante.RequisitanteId" />
						}

						<div class="col-12 px-3" style="border-bottom:1px solid #325d88">
							<h2 class="text-primary">
								@(Model.RequisitanteObj.Requisitante.RequisitanteId != Guid.Empty ? "Atualizar " : "Criar ") Requisitante
							</h2>
						</div>

						<div class="col-12 pt-3">
							<div class="row">
								<div class="col-6 col-md-2">
									<div class="form-group">
										<label class="label font-weight-bold" asp-for="RequisitanteObj.Requisitante.Ponto"></label>
										<span class="text-danger font-weight-light" asp-validation-for="RequisitanteObj.Requisitante.Ponto"></span>
										<input class="form-control form-control-xs" asp-for="RequisitanteObj.Requisitante.Ponto" placeholder="Ex: p_123" />
									</div>
								</div>

								<div class="col-12 col-md-5">
									<div class="form-group">
										<label class="label font-weight-bold" asp-for="RequisitanteObj.Requisitante.Nome"></label>
										<span class="text-danger font-weight-light" asp-validation-for="RequisitanteObj.Requisitante.Nome"></span>
										<input class="form-control form-control-xs" asp-for="RequisitanteObj.Requisitante.Nome" placeholder="Nome do requisitante" />
									</div>
								</div>

								<div class="col-6 col-md-2">
									<div class="form-group">
										<label class="label font-weight-bold" asp-for="RequisitanteObj.Requisitante.Ramal"></label>
										<span class="text-danger font-weight-light" asp-validation-for="RequisitanteObj.Requisitante.Ramal"></span>
										<input class="form-control form-control-xs" asp-for="RequisitanteObj.Requisitante.Ramal" type="number" placeholder="Ramal" />
									</div>
								</div>

								<div class="col-12 col-md-3">
									<div class="form-group">
										<label class="label font-weight-bold" asp-for="RequisitanteObj.Requisitante.Email"></label>
										<span class="text-danger font-weight-light" asp-validation-for="RequisitanteObj.Requisitante.Email"></span>
										<input class="form-control form-control-xs" asp-for="RequisitanteObj.Requisitante.Email" type="email" placeholder="email@exemplo.com" />
									</div>
								</div>
							</div>

							<div class="row">
								<div class="col-12 col-md-6">
									<div id="ControlRegion">
										<div class="form-control-xs" style="font-size:13px; width:100%;">
											<label style="font-size:13px;" class="label font-weight-bold">Setor Solicitante</label>

											<ejs-dropdowntree id="ddtree"
															  placeholder="Selecione um Setor"
															  sortOrder="Ascending"
															  showCheckBox="false"
															  allowMultiSelection="false"
															  allowFiltering="true"
															  filterType="Contains"
															  filterBarPlaceholder="Procurar..."
															  select="select"
															  change="valueChange"
															  ejs-for="@Model.RequisitanteObj.Requisitante.SetorSolicitanteId">
												<e-dropdowntree-fields dataSource="@ViewData["dataSource"]"
																	   value="SetorSolicitanteId"
																	   text="Nome"
																	   parentValue="SetorPaiId"
																	   hasChildren="HasChild">
												</e-dropdowntree-fields>
											</ejs-dropdowntree>
										</div>
									</div>
								</div>
							</div>

							<br />
							<br />

							<div class="row">
								<div class="col-12">
									<div class="form-group">
										<label class="font-weight-bold" asp-for="RequisitanteObj.Requisitante.Status">
											<span class="text-danger font-weight-light" asp-validation-for="RequisitanteObj.Requisitante.Status"></span>
											<input type="checkbox" class="form-check-input" asp-for="RequisitanteObj.Requisitante.Status" /> Ativo/Inativo
										</label>
									</div>
								</div>
							</div>

							<br />

							<div class="form-group row">
								<div class="col-12 col-sm-9 col-md-6">
									<div class="row">
										<div class="col-6">
											@if (Model.RequisitanteObj.Requisitante.RequisitanteId != Guid.Empty)
											{
												<button type="submit"
														asp-page-handler="Edit"
														asp-route-id="@Model.RequisitanteObj.Requisitante.RequisitanteId"
														class="btn btn-azul btn-submit-spin form-control"
														data-ejtip="Atualizar Requisitante">
													<i class="fa-duotone fa-floppy-disk icon-space icon-pulse"></i>
													Atualizar Requisitante
												</button>
											}
											else
											{
												<button type="submit"
														value="Submit"
														asp-page-handler="Submit"
														class="btn btn-azul btn-submit-spin form-control"
														data-ejtip="Criar Requisitante">
													<i class="fa-duotone fa-floppy-disk icon-space icon-pulse"></i>
													Criar Requisitante
												</button>
											}
										</div>
										<div class="col-6">
											<a asp-page="./Index" class="btn btn-ftx-fechar form-control" data-ejtip="Cancelar e voltar à lista" data-ftx-loading>
												<i class="fa-duotone fa-circle-xmark icon-space icon-pulse"></i>
												Cancelar Operação
											</a>
										</div>
									</div>
								</div>
							</div>
						</div> <!-- /.col-12 pt-3 -->
					</div> <!-- /.panel-content -->
				</div> <!-- /.panel-container -->
			</div> <!-- /.panel -->
		</div> <!-- /.col-xl-12 -->
	</div> <!-- /.row -->
</form>

@section ScriptsBlock {
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" crossorigin="anonymous" />
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>

	<script type="text/javascript">
		$(document).ready(function () {
			try {
				// Pré-seleciona o Setor, se existir
				var setorId = "@Model.RequisitanteObj.Requisitante.SetorSolicitanteId";
				if (setorId && setorId !== "00000000-0000-0000-0000-000000000000") {
					document.getElementById("ddtree").ej2_instances[0].value = [setorId];
				}
			} catch (error) {
				Alerta.TratamentoErroComLinha("Upsert.cshtml", "document.ready", error);
			}
		});
	</script>

	<script type="text/javascript">
		function valueChange() {
			try {
				var ddTreeObj = document.getElementById("ddtree").ej2_instances[0];
				console.info(ddTreeObj.value + " - " + ddTreeObj.text);
			} catch (error) {
				Alerta.TratamentoErroComLinha("Upsert.cshtml", "valueChange", error);
			}
		}

		function select(args) {
			try {
				var ddTreeObj = document.getElementById("ddtree").ej2_instances[0];
				console.info(ddTreeObj.value + " - " + ddTreeObj.text);
			} catch (error) {
				Alerta.TratamentoErroComLinha("Upsert.cshtml", "select", error);
			}
		}
	</script>
}
